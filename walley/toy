#!/usr/bin/env python
from toy import *
import sys
print sys.argv

# COMMANDS

# run one file
if len(sys.argv)==2:
    file_name=sys.argv[1]
    file=open(file_name)
    string_in_side = file.read()
    #print "\n\nLexer---->\n"
    #print "--> "+string_in_side
    x=lexer(string_in_side)
    #print x
    if x[1]==False:
        print "Incomplete Statement"
        exit(0)
    x=parser(x[0])
    #print "\n\nParser---->\n"
    #print x
    #print "Parser----> ",
    #print x
    interpreter(x)

# compress file
elif len(sys.argv)==3 and sys.argv[1]=="compress":
    file_name=sys.argv[2]
    file=open(file_name)
    string_in_side = file.read()

    x = lexer(string_in_side)[0]
    if x[1]==False:
        print "Incomplete Statement\nCannot compress file "+file_name
        exit(0)
    i=0
    output = ""
    length = len(x)
    while i<length:
        if x[i]=="(":
            output = output+"("
            i=i+1
            continue
        else:
            # deal with string problem
            if x[i][0]=="\"":
                x[i]="\\"+x[i]
                x[i]=x[i][0:len(x[i])-1]
                x[i]=x[i]+"\\\""
            output=output+x[i]
            if i+1!=length and x[i+1]==")":
                i=i+1
            else:
                output=output+" "
                i=i+1
    print "====================\n\n\n"
    print output


elif len(sys.argv)==1:
    print "Toy Language >>>>>>>>>>>>>>>"
    print "Press ctrl+C to quit\n"
    while True:
        print ">>> ",
        x=raw_input()
        if x=="":
            continue
        x=lexer(x)
        #print "Lexer----> ",
        #print x
        if x[1]==False:
            print "Incomplete Statement"
            continue
        x=parser(x[0])
        #print "Parser----> ",
        #print x
        print interpreter(x)
else:
    print "Argv Error.."


